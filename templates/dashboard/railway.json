{
  "$schema": "https://railway.com/railway.schema.json",
  "build": {
    "builder": "RAILPACK",
    "buildCommand": "npm run build"
  },
  "deploy": {
    "startCommand": "npm run start",
    "healthcheckPath": "/api/public/stats",
    "healthcheckTimeout": 30,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 3,
    "numReplicas": 1
  },
  "services": {
    "web": {
      "source": {
        "repo": "supaku/agentfactory"
      },
      "variables": {
        "LINEAR_ACCESS_TOKEN": {
          "description": "Linear API key (Settings > API > Personal API Keys)",
          "required": true
        },
        "LINEAR_WEBHOOK_SECRET": {
          "description": "Webhook signing secret (Settings > API > Webhooks)",
          "required": true
        },
        "REDIS_URL": {
          "description": "Redis connection URL (auto-injected from companion Redis service)",
          "reference": "redis.REDIS_URL"
        },
        "NEXT_PUBLIC_APP_URL": {
          "description": "Public URL (auto-set by Railway)",
          "generator": "RAILWAY_PUBLIC_DOMAIN"
        },
        "WORKER_API_KEY": {
          "description": "Bearer token for worker auth (optional)",
          "required": false
        },
        "PORT": {
          "default": "3000"
        }
      },
      "networking": {
        "port": 3000
      }
    },
    "redis": {
      "plugin": "redis",
      "variables": {}
    }
  }
}
